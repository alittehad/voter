<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ward 20 Management</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.btn3d {
  box-shadow: 0 4px #1e3a8a;
  transition: 0.1s;
}
.btn3d:active {
  transform: translateY(3px);
  box-shadow: 0 1px #1e3a8a;
}
.card3d {
  box-shadow: 0 6px 0 #1e3a8a;
}
</style>
</head>
<body class="bg-gray-100">

<!-- LOGIN DIV -->
<div id="loginDiv" class="hidden min-h-screen flex flex-col justify-center items-center p-5">
  <h1 class="text-3xl font-bold mb-5">Ward 20</h1>
  <button onclick="googleLogin()" class="btn3d bg-blue-600 text-white px-6 py-3 rounded-lg">Login with Google</button>
</div>

<!-- MAIN DIV -->
<div id="mainDiv" class="hidden p-4 space-y-4">

  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="hidden card3d bg-white p-4 rounded-xl">
    <h2 class="text-xl font-bold mb-3">Admin Panel</h2>

    <!-- Screen Image Upload -->
    <div class="mb-4">
      <label class="font-semibold">Screen Image Upload:</label>
      <input type="file" id="screenImage" class="block mt-2" />
      <button onclick="uploadScreenImage()" class="mt-2 btn3d bg-green-600 text-white px-4 py-2 rounded-lg">Upload</button>
    </div>

    <!-- Add User -->
    <div class="mb-4">
      <h3 class="font-semibold mb-2">Add User / Member</h3>
      <input id="newName" placeholder="Name" class="border p-2 w-full mb-2" />
      <input id="newEmail" placeholder="Email" class="border p-2 w-full mb-2" />
      <select id="newRole" class="border p-2 w-full mb-2">
        <option value="user">User</option>
        <option value="member">Member</option>
      </select>
      <button onclick="addUser()" class="btn3d bg-blue-700 text-white px-4 py-2 rounded-lg">Add</button>
    </div>

  </div>

  <!-- MEMBER PANEL -->
  <div id="memberPanel" class="hidden card3d bg-white p-4 rounded-xl">
    <h2 class="text-xl font-bold">Member Panel</h2>
    <p>Survey form yahan aayega…</p>
  </div>

  <!-- USER PANEL -->
  <div id="userPanel" class="hidden card3d bg-white p-4 rounded-xl">
    <h2 class="text-xl font-bold">User Panel</h2>
    <p>Voter list yahan aayegi…</p>
  </div>

</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase Config (aapka existing config lagana)
const firebaseConfig = {};
firebase.initializeApp(firebaseConfig);

function googleLogin() {
  var provider = new firebase.auth.GoogleAuthProvider();
  firebase.auth().signInWithPopup(provider);
}

firebase.auth().onAuthStateChanged(user => {
  if (!user) {
    document.getElementById("loginDiv").style.display = "flex";
    document.getElementById("mainDiv").style.display = "none";
    return;
  }

  document.getElementById("loginDiv").style.display = "none";
  document.getElementById("mainDiv").style.display = "block";

  const emailKey = user.email.replace(/\./g, "_");

  firebase.database().ref("users/" + emailKey).once("value")
    .then(snapshot => {
      if (!snapshot.exists()) {
        alert("Not Authorized!");
        firebase.auth().signOut();
        return;
      }

      const role = snapshot.val().role;

      if (role === "admin") showAdminPanel();
      else if (role === "member") showMemberPanel();
      else showUserPanel();
    });
});

function showAdminPanel() {
  adminPanel.style.display = "block";
  memberPanel.style.display = "none";
  userPanel.style.display = "none";
}
function showMemberPanel() {
  adminPanel.style.display = "none";
  memberPanel.style.display = "block";
  userPanel.style.display = "none";
}
function showUserPanel() {
  adminPanel.style.display = "none";
  memberPanel.style.display = "none";
  userPanel.style.display = "block";
}

function uploadScreenImage() {
  alert("Yahan Firebase Storage upload ka code lagega.");
}
function addUser() {
  alert("User add function yahan complete hoga.");
}
</script>

</body>
</html>
