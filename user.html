<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Election Voter List</title>

<style>
    body {
        font-family: Arial, sans-serif;
    }
    h2{text-align:center;}

    #searchBox {
        width:90%;
        padding:12px;
        margin:15px auto;
        display:block;
        font-size:18px;
        border-radius:10px;
        border: 2px solid black;
    }

    table {
        width: 95%;
        margin:auto;
        border-collapse: collapse;
        font-size:18px;
    }

    th, td {
        padding:10px;
        border-bottom: 2px solid black;
        cursor:pointer;
    }

    /* Highlight selected row */
    .selectedRow{
        font-weight:bold;
        color:white;
    }

    /* Popup Card */
    #popup {
        position:fixed;
        top:50%; left:50%;
        transform: translate(-50%, -50%);
        width:360px;
        padding:20px;
        background:white;
        border-radius:15px;
        display:none;
        box-shadow:0px 0px 25px rgba(0,0,0,0.3);
        animation: zoom .3s ease-in-out;
    }
    @keyframes zoom{from{scale:0.4;}to{scale:1;}}

    #popup button {
        width:100%;
        padding:10px;
        border-radius:10px;
        margin-top:7px;
        cursor:pointer;
        font-size:16px;
    }

    .close-btn{
        background:red;
        color:white;
    }

    .color-btns{
        display:flex;
        gap:5px;
        margin:10px 0;
    }

    .color-btns button{
        flex:1;
        padding:8px;
        border-radius:10px;
        cursor:pointer;
        color:white;
        border:none;
    }

    /* Print only popup */
    @media print {
        body * { visibility: hidden; }
        #popup, #popup * { visibility: visible; }
        #popup { position:absolute; top:0; left:0; width:100%; box-shadow:none;}
    }

</style>
</head>
<body>

<h2>üìã Election Voter List</h2>

<input type="text" id="searchBox" placeholder="üîç ‡§ñ‡•ã‡§ú‡•á‡§Ç: ‡§®‡§æ‡§Æ / EPIC ‡§®‡§Ç‡§¨‡§∞ / Part No">

<table id="voterTable"></table>

<div id="popup"></div>

<script>

const data = {
  "Voters": {
    "Bcd0598334": {
      "Epic": "BCD0598334",
      "Name": "Sanjay Malakar",
      "AcNo": 131,
      "PartNo": 92,
      "Description": "Active Voter"
    },
    "Djm1162627": {
      "Epic": "DJM1162627",
      "Name": "Jagdish Gajanan Gurav",
      "AcNo": 131,
      "PartNo": 237,
      "Description": "Regular Voter"
    },
    "Ltv1989003": {
      "Epic": "LTV1989003",
      "Name": "Jayprakash Gopal Shende",
      "AcNo": 131,
      "PartNo": 14,
      "Description": "Senior Citizen"
    }
  }
};

let selectedRow = null;
let currentColor = "black";
let selectedData = null;


function loadTable(){
    const table = document.getElementById("voterTable");
    table.innerHTML = `
        <tr><th>EPIC</th><th>Name</th><th>AC</th><th>Part No</th></tr>
    `;

    for(let id in data.Voters){
        let v = data.Voters[id];
        table.innerHTML += `
        <tr onclick="selectVoter(this,'${id}')">
            <td>${v.Epic}</td>
            <td>${v.Name}</td>
            <td>${v.AcNo}</td>
            <td>${v.PartNo}</td>
        </tr>`;
    }
}
loadTable();


document.getElementById("searchBox").addEventListener("keyup", function(){
    let filter = this.value.toLowerCase();
    document.querySelectorAll("#voterTable tr").forEach((row,i)=>{
        if(i===0) return;
        row.style.display = row.innerText.toLowerCase().includes(filter) ? "" : "none";
    });
});


function selectVoter(row,id){

    if(selectedRow) selectedRow.classList.remove("selectedRow");
    selectedRow=row;
    selectedRow.classList.add("selectedRow");
    selectedData=data.Voters[id];

    applyColor(currentColor);
    showPopup();
}


function applyColor(color){
    currentColor=color;

    if(selectedRow){
        selectedRow.style.background=color;
        selectedRow.style.color="white";
    }

    let popup=document.getElementById("popup");
    popup.style.border=`4px solid ${color}`;
}


function showPopup(){
    let v=selectedData;
    const popup=document.getElementById("popup");

    popup.innerHTML = `
        <h3 style="text-align:center">ü™™ Voter Details</h3>

        <p><b>Name:</b> ${v.Name}</p>
        <p><b>EPIC:</b> ${v.Epic}</p>
        <p><b>AC No:</b> ${v.AcNo}</p>
        <p><b>Part No:</b> ${v.PartNo}</p>
        <p><b>Note:</b> ${v.Description}</p>

        <div class="color-btns">
            <button style="background:#ff7675" onclick="applyColor('#ff7675')">Red</button>
            <button style="background:#74b9ff" onclick="applyColor('#74b9ff')">Blue</button>
            <button style="background:#55efc4" onclick="applyColor('#55efc4')">Green</button>
        </div>

        <button onclick="window.print()">üñ® Print Card</button>
        <button onclick="shareOnWhatsapp()">üì≤ Send via WhatsApp</button>
        <button class="close-btn" onclick="closePopup()">‚ùå Close</button>
    `;
    popup.style.display="block";
}

function shareOnWhatsapp(){
    let v=selectedData;
    let msg = `üó≥ *Voter Information*  
--------------------
üë§ Name: ${v.Name}
üÜî EPIC: ${v.Epic}
üìç AC No: ${v.AcNo}
üìÑ Part No: ${v.PartNo}
üìù Note: ${v.Description}
--------------------
Sent from Voter App`;

    window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, "_blank");
}

function closePopup(){ 
    document.getElementById("popup").style.display="none"; 
}

</script>
</body>
</html>
