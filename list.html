<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Voter List Preview</title>
<style>
body { font-family: Arial, sans-serif; padding: 10px; }
h2 { text-align: center; }
</style>
</head>
<body>

<h2>ЁЯЧ│ Voter List Preview</h2>

<!-- ЁЯМР TRANSLATION DROPDOWN ADDED -->
<div style="text-align:center; margin-bottom:15px;">
    <select id="translateMenu" style="padding:10px; font-size:16px; border-radius:8px; border:2px solid #007bff; width:90%; max-width:350px;">
        <option value="" selected>ЁЯМР рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ / Select Language</option>
        <option value="mr-en">Marathi тЖТ English</option>
        <option value="en-mr">English тЖТ Marathi</option>
    </select>
</div>

<div id="contentArea">
    <p>рд╡рд╕рдИ рд╡рд┐рд░рд╛рд░ рдорд╣рд╛рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛</p>
    <p>рдкреНрд░рднрд╛рдЧ рдХреНрд░ : рео - рд╡реЙрд░реНрдб рео</p>
    <p>рдпрд╛рджреА рднрд╛рдЧ рдХреНрд░. реиренреи : рез - рдзрд╛рдиреАрд╡рдЧрд╛рдВрд╡рдмрд╛-рд╣рд╛рдЪрд╛рдкрд╛рдбрд╛рдзрд╛рдиреАрд╡рд╣рд░рд╡рдЯреЗ</p>
    <p>рдореБрд│ рдкреНрд░рд╛рд░реВрдк рдорддрджрд╛рд░ рдпрд╛рджреА</p>
    <p>рджрд┐рдирд╛рдВрдХ реиреж-резрез-реирежреирел</p>
</div>

<script>
// тнР WORKING TRANSLATION USING LIBRETRANSLATE
async function translatePage(from, to) {
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT, null, false);

    let nodes = [];
    let texts = [];

    while (walker.nextNode()) {
        let n = walker.currentNode;
        let t = n.textContent.trim();
        if (t.length > 1) {
            nodes.push(n);
            texts.push(t);
        }
    }

    if (texts.length === 0) return;

    try {
        let res = await fetch("https://libretranslate.de/translate", {
            method: "POST",
            body: JSON.stringify({ q: texts.join("\n"), source: from, target: to, format: "text" }),
            headers: { "Content-Type": "application/json" }
        });

        let data = await res.json();
        let translated = data.translatedText.split("\n");

        translated.forEach((t, i) => {
            nodes[i].textContent = t;
        });

    } catch (e) {
        alert("Translation failed again!");
        console.error(e);
    }
}

// Dropdown listener

document.getElementById("translateMenu").addEventListener("change", function () {
    let val = this.value;
    if (val === "mr-en") translatePage("mr", "en");
    if (val === "en-mr") translatePage("en", "mr");
    this.value = "";
});
</script>

</body>
</html>
