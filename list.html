<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voter List</title>
<style>
body { font-family: Arial; margin:0; padding:10px; background:#f1f1f1; }
h2 { text-align:center; margin-bottom:15px; }

/* Search Box */
#searchBox {
Â  width:100%; padding:10px; border:2px solid #999; border-radius:6px;
Â  font-size:18px; margin-bottom:15px;
}

/* Result List */
.result-item {
Â  padding:10px; margin:5px 0; background:white;
Â  border-radius:6px; border-left:5px solid #007bff;
Â  cursor:pointer;
Â  display:flex; justify-content:space-between; align-items:center;
}

/* Card Popup */
#card {
Â  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
Â  background:rgba(0,0,0,0.7); justify-content:center; align-items:flex-start;
Â  padding:20px; overflow-y:auto;
}
.card-content{
Â  background:white; padding:15px; border-radius:10px; max-width:450px; width:95%;
Â  position:relative;
}

.close-btn{
Â  position:absolute; top:10px; right:10px; background:red; border:none;
Â  color:white; padding:5px 10px; border-radius:5px; cursor:pointer;
}

.color-btn {
Â  width:30px; height:30px; border-radius:6px;
Â  border:none; margin-right:8px; cursor:pointer;
}

#msg {
Â  width:100%; height:80px; padding:8px;
Â  border:2px solid #aaa; border-radius:6px;
}

.btn-small {
Â  padding:8px 15px; border:none; border-radius:6px;
Â  margin-right:10px; cursor:pointer; color:white;
}
.btn-save { background:#28a745; }
.btn-del { background:#dc3545; }
.btn-print { background:#007bff; }
.btn-whatsapp { background:#25d366; }

.voter-color-tag {
Â  width:20px; height:20px; border-radius:4px; display:inline-block;
}

/* Added CSS for Marquee */
.marquee-container {
Â  Â  padding: 5px 0;
Â  Â  margin-bottom: 10px;
Â  Â  background: #007bff; /* Dark blue background for contrast */
Â  Â  border-radius: 5px;
Â  Â  overflow: hidden;
Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}
.marquee-text {
Â  Â  color: #ffffff; /* White text */
Â  Â  font-size: 20px;
Â  Â  font-weight: bold;
Â  Â  text-shadow: 2px 2px 4px #000000; /* Simple 3D effect using text shadow */
Â  Â  white-space: nowrap;
}

/* ðŸŒŸ CSS for Colorful Notice Box ðŸŒŸ */
#noticeBox {
    padding: 10px;
    margin-bottom: 15px;
    border-radius: 8px;
    /* Colorful Gradient Background */
    background: linear-gradient(90deg, #ff7e5f, #feb47b); 
    color: white;
    font-weight: bold;
    text-align: center;
    box-shadow: 0 4px 8px rgba(255, 126, 95, 0.4); /* Shadow matching the color */
    border: 1px solid #ff7e5f;
}
</style>
</head>
<body>

<div class="marquee-container">
Â  Â  <marquee class="marquee-text" direction="left" scrollamount="6">
Â  Â  Â  Â  âœ¨ VOTER SEARCH SYSTEM - FAST AND RELIABLE DATA ACCESS âœ¨
Â  Â  </marquee>
</div>

<div id="noticeBox">
    ðŸ”´ Important Notice: Data updated as of 27/11/2025. Please verify details.
</div>

<h2>Voter Search</h2>
<input type="text" id="searchBox" placeholder="Type 1 letter to search..." />
<div id="results"></div>

<div id="card">
Â  <div class="card-content">
Â  Â  <button class="close-btn" onclick="closeCard()">X</button>
Â  Â  <h3 id="vname"></h3>
Â  Â  <p><b>EPIC:</b> <span id="vepic"></span></p>
Â  Â  <p><b>Serial/Part:</b> <span id="vserial"></span></p>
Â  Â  <p><b>Address:</b> <span id="varea"></span></p>
Â  Â  <p><b>Relation:</b> <span id="vrelation"></span></p>
Â  Â  <p><b>Age/Gender:</b> <span id="vage"></span> / <span id="vgender"></span></p>
Â  Â  <p><b>Saved Color:</b> <span class="voter-color-tag" id="colortag"></span></p>

Â  Â  <hr>
Â  Â  <p><b>Change Color:</b></p>
Â  Â  <button class="color-btn" style="background:#ff4444" onclick="saveColor('#ff4444')"></button>
Â  Â  <button class="color-btn" style="background:#44cc44" onclick="saveColor('#44cc44')"></button>
Â  Â  <button class="color-btn" style="background:#4477ff" onclick="saveColor('#4477ff')"></button>

Â  Â  <hr>
Â  Â  <p><b>Sender Message:</b></p>
Â  Â  <textarea id="msg"></textarea>


Â  Â  <button class="btn-small btn-save" onclick="saveMessage()">Save</button>
Â  Â  <button class="btn-small btn-del" onclick="deleteMessage()">Delete</button>

Â  Â  <hr>
Â  Â  <button class="btn-small btn-print" onclick="printCard()">Print</button>
Â  Â  <button class="btn-small btn-whatsapp" onclick="sendWhatsApp()">Send</button>
Â  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase config
const firebaseConfig = {
Â  apiKey: "AIzaSyCdjqVFKOQ1dtaXCGFUUtsJWbFdGNTo-xw",
Â  authDomain: "voter-25c94.firebaseapp.com",
Â  databaseURL: "https://voter-25c94-default-rtdb.firebaseio.com",
Â  projectId: "voter-25c94",
Â  storageBucket: "voter-25c94.appspot.com",
Â  messagingSenderId: "297773534400",
Â  appId: "1:297773534400:web:3722c487b8c83e9b787125"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let voters = [];
let activeVoter = null;

// Load voters from Firebase
db.ref("voters").once("value").then(snap => {
Â  Â  const data = snap.val() || {};
Â  Â  voters = Object.keys(data).map(key => ({
Â  Â  Â  Â  key: key,
Â  Â  Â  Â  epic_no: data[key].epic_no || key,
Â  Â  Â  Â  voter_full_name: data[key].voter_full_name || "",
Â  Â  Â  Â  sl_no_in_part: data[key].sl_no_in_part || "",
Â  Â  Â  Â  house_number: data[key].house_number || "",
Â  Â  Â  Â  relation_name: data[key].relation_name || "",
Â  Â  Â  Â  relation_type: data[key].relation_type || "",
Â  Â  Â  Â  age: data[key].age || "",
Â  Â  Â  Â  gender: data[key].gender || "",
Â  Â  Â  Â  color: data[key].color || "#ffffff",
Â  Â  Â  Â  message: data[key].message || ""
Â  Â  }));
Â  Â  renderResults();
});

// Render search results
function renderResults() {
Â  const q = document.getElementById("searchBox").value.toLowerCase();
Â  let html = "";
Â  if (q.length >= 1) {
Â  Â  voters.forEach(v => {
Â  Â  Â  if (v.voter_full_name.toLowerCase().includes(q) || v.epic_no.toLowerCase().includes(q)) {
Â  Â  Â  Â  html += `<div class="result-item" onclick="openCard('${v.key}')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span><b>${v.voter_full_name}</b> (${v.epic_no})</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="voter-color-tag" style="background:${v.color}"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â </div>`;
Â  Â  Â  }
Â  Â  });
Â  }
Â  document.getElementById("results").innerHTML = html;
}

// Search input
document.getElementById("searchBox").addEventListener("input", renderResults);

// Open card popup
function openCard(key){
Â  Â  activeVoter = voters.find(v=>v.key===key);
Â  Â  if(!activeVoter) return;

Â  Â  document.getElementById("vname").innerText = activeVoter.voter_full_name;
Â  Â  document.getElementById("vepic").innerText = activeVoter.epic_no;
Â  Â  document.getElementById("vserial").innerText = activeVoter.sl_no_in_part;
Â  Â  document.getElementById("varea").innerText = activeVoter.house_number;
Â  Â  document.getElementById("vrelation").innerText = `${activeVoter.relation_name} (${activeVoter.relation_type})`;
Â  Â  document.getElementById("vage").innerText = activeVoter.age;
Â  Â  document.getElementById("vgender").innerText = activeVoter.gender;

Â  Â  document.getElementById("colortag").style.background = activeVoter.color;
Â  Â  document.getElementById("msg").value = activeVoter.message;

Â  Â  document.getElementById("card").style.display = "flex";
}

// Close card
function closeCard(){
Â  Â  document.getElementById("card").style.display = "none";
}

// Save color
function saveColor(c){
Â  Â  if(!activeVoter) return;
Â  Â  activeVoter.color = c;
Â  Â  db.ref("voters/"+activeVoter.key+"/color").set(c);
Â  Â  document.getElementById("colortag").style.background = c;
Â  Â  renderResults(); // update color in list
}

// Save message
function saveMessage(){
Â  Â  if(!activeVoter) return;
Â  Â  activeVoter.message = document.getElementById("msg").value;
Â  Â  db.ref("voters/"+activeVoter.key+"/message").set(activeVoter.message);
Â  Â  alert("Message saved!");
}

// Delete message
function deleteMessage(){
Â  Â  if(!activeVoter) return;
Â  Â  db.ref("voters/"+activeVoter.key+"/message").remove();
Â  Â  document.getElementById("msg").value = "";
}

// Print
function printCard(){
Â  Â  if(!activeVoter) return;
Â  Â  let text = `
Name: ${activeVoter.voter_full_name}
EPIC: ${activeVoter.epic_no}
Serial/Part: ${activeVoter.sl_no_in_part}
Address: ${activeVoter.house_number}
Relation: ${activeVoter.relation_name} (${activeVoter.relation_type})
Age/Gender: ${activeVoter.age} / ${activeVoter.gender}

Message:
${activeVoter.message}
`;
Â  Â  let w = window.open("", "", "width=400,height=600");
Â  Â  w.document.write("<pre>"+text+"</pre>");
Â  Â  w.print();
}

// WhatsApp send
function sendWhatsApp(){
Â  Â  if(!activeVoter) return;
Â  Â  let text = `*Voter Details*\nName: ${activeVoter.voter_full_name}\nEPIC: ${activeVoter.epic_no}\nSerial/Part: ${activeVoter.sl_no_in_part}\nAddress: ${activeVoter.house_number}\nRelation: ${activeVoter.relation_name} (${activeVoter.relation_type})\nAge/Gender: ${activeVoter.age} / ${activeVoter.gender}\n\nMessage:\n${activeVoter.message}`;
Â  Â  let url = "https://wa.me/?text=" + encodeURIComponent(text);
Â  Â  window.open(url, "_blank");
}
</script>
</body>
</html>
