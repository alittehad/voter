<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Voter Preview Only</title>
<style>
body { font-family: Arial; margin:0; padding:10px; background:#f3f3f3; }
h2 { text-align:center; margin-bottom:10px; font-size:16px; text-transform: lowercase; }
input, textarea, select {
┬а ┬а width:100%; padding:8px; margin-bottom:8px;
┬а ┬а border-radius:6px; border:1px solid #777; font-size:14px;
┬а ┬а text-transform: lowercase;
}
.list-item{
┬а ┬а padding:6px 8px; background:white;
┬а ┬а border:1px solid #aaa; margin-bottom:4px;
┬а ┬а border-radius:6px; cursor:pointer;
┬а ┬а transition:.2s; font-size:12px;
┬а ┬а text-transform: lowercase; line-height:1.3em;
┬а ┬а word-break: break-word;
}
.highlight { background: #ffe08a !important; border-color:#d6a300 !important; }
.list-item:hover{ transform:scale(1.03); box-shadow:0 0 6px gray; }

#popup{
┬а ┬а position:fixed;top:0;left:0;width:100%;height:100%;
┬а ┬а background:rgba(0,0,0,0.7);display:none;
┬а ┬а justify-content:center;align-items:flex-start;
┬а ┬а padding:20px;overflow-y:auto;
}
.card{
┬а ┬а width:95%;max-width:420px;background:white;
┬а ┬а border:3px solid black;border-radius:12px;padding:15px;
┬а ┬а font-size:13px; text-transform: lowercase;
}
.card img{
┬а ┬а width:100%;max-height:180px;object-fit:contain;
┬а ┬а border-radius:10px;margin-bottom:8px;
}
.btn{
┬а ┬а padding:10px;width:100%;margin-top:8px;background:#008cff;
┬а ┬а color:white;border:none;font-size:14px;cursor:pointer;
┬а ┬а border-radius:8px;box-shadow:0 3px 0 #003f7f;
}
.btn:active{ transform:translateY(3px); }
.close-btn{ background:red;box-shadow:0 3px 0 #7a0000; }
.color-btn{ background:#ffa600; box-shadow:0 3px 0 #b36b00; }

/* PRINT */
@media print{
┬а ┬а body *{ visibility:hidden; }
┬а ┬а #popup, #popup *{ visibility:visible; }
┬а ┬а .btn{ display:none !important; }
}
.lang-switch { text-align:center; margin-bottom:10px; }
.lang-switch select { padding:6px 10px; font-size:14px; border-radius:6px; border:1px solid #007bff; }
</style>
</head>
<body>

<div class="lang-switch">
┬а <select id="lang">
┬а ┬а <option value="mr">ЁЯЗоЁЯЗ│ рдорд░рд╛рдареА (Marathi)</option>
┬а ┬а <option value="en">ЁЯЗоЁЯЗ│ English</option>
┬а </select>
</div>

<div id="translateArea">
┬а ┬а <h2 class="label" data-mr="ЁЯЧ│ рдорддрджрд╛рд░ рдпрд╛рджреА рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди" data-en="ЁЯЧ│ Voter List Preview">ЁЯЧ│ рдорддрджрд╛рд░ рдпрд╛рджреА рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди</h2>
┬а ┬а <label class="label" data-mr="рдорддрджрд╛рддрд╛ рд╢реЛрдзрд╛" data-en="Search Voter:">рдорддрджрд╛рддрд╛ рд╢реЛрдзрд╛</label>
</div>

<input id="search" class="label"┬а
┬а ┬а ┬а ┬аdata-mr="рдирд╛рд╡, EPIC, AC рдХреНрд░., рднрд╛рдЧ рдХреНрд░., рдкрддреНрддрд╛ рд╢реЛрдзрд╛"┬а
┬а ┬а ┬а ┬аdata-en="Search Name, EPIC, AC No, Part No, Address, Booth, Message..."
┬а ┬а ┬а ┬аplaceholder="рдирд╛рд╡, EPIC, AC рдХреНрд░., рднрд╛рдЧ рдХреНрд░., рдкрддреНрддрд╛ рд╢реЛрдзрд╛">
<div id="list"></div>

<div id="popup">
┬а ┬а <div class="card" id="cardBox">
┬а ┬а ┬а ┬а <h3 id="pName"></h3>
┬а ┬а ┬а ┬а <p><b class="label" data-mr="ЁЯЖФ EPIC рдХреНрд░рдорд╛рдВрдХ:" data-en="ЁЯЖФ EPIC:">ЁЯЖФ EPIC рдХреНрд░рдорд╛рдВрдХ:</b> <span id="pEpic"></span></p>
┬а ┬а ┬а ┬а <p><b class="label" data-mr="ЁЯПЫ рд╡рд┐рдзрд╛рдирд╕рднрд╛:" data-en="ЁЯПЫ AC No:">ЁЯПЫ рд╡рд┐рдзрд╛рдирд╕рднрд╛:</b> <span id="pAc"></span></p>
┬а ┬а ┬а ┬а <p><b class="label" data-mr="ЁЯУН рднрд╛рдЧ рдХреНрд░рдорд╛рдВрдХ:" data-en="ЁЯУН Part No:">ЁЯУН рднрд╛рдЧ рдХреНрд░рдорд╛рдВрдХ:</b> <span id="pPart"></span></p>
┬а ┬а ┬а ┬а <p><b class="label" data-mr="ЁЯПа рдкрддреНрддрд╛:" data-en="ЁЯПа Address:">ЁЯПа рдкрддреНрддрд╛:</b> <span id="pAddress"></span></p>
┬а ┬а ┬а ┬а <p><b class="label" data-mr="ЁЯЧ│ рдорддрджрд╛рди рдХреЗрдВрджреНрд░:" data-en="ЁЯЧ│ Booth:">ЁЯЧ│ рдорддрджрд╛рди рдХреЗрдВрджреНрд░:</b> <span id="pVoteAddress"></span></p>

┬а ┬а ┬а ┬а <img id="voterImage" style="display:none; margin-top:10px;">

┬а ┬а ┬а ┬а <label class="label" data-mr="ЁЯУЭ рд╕рдВрджреЗрд╢:" data-en="ЁЯУЭ Sender Message:"><b>ЁЯУЭ рд╕рдВрджреЗрд╢:</b></label>
┬а ┬а ┬а ┬а <input id="senderNote" placeholder="рд╕рдВрджреЗрд╢ рдЯрд╛рдХрд╛ / Type message here">

┬а ┬а ┬а ┬а <button class="btn color-btn" onclick="highlightItem()">ЁЯОи рд╣рд╛рдпрд▓рд╛рдЗрдЯ / Highlight</button>
┬а ┬а ┬а ┬а <button class="btn" onclick="printDetails()">ЁЯЦи рдЫрд╛рдкрд╛ / Print</button>
┬а ┬а ┬а ┬а <button class="btn" onclick="sendWhatsApp()">ЁЯУй WhatsApp</button>
┬а ┬а ┬а ┬а <button class="btn close-btn" onclick="closePopup()">тЭМ рдмрдВрдж рдХрд░рд╛ / Close</button>
┬а ┬а </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase.js"></script>
<script>
// Firebase config
firebase.initializeApp({
┬а apiKey: "AIzaSyCdjqVFKOQ1dtaXCGFUUtsJWbFdGNTo-xw",
┬а authDomain: "voter-25c94.firebaseapp.com",
┬а databaseURL: "https://voter-25c94-default-rtdb.firebaseio.com/",
┬а projectId: "voter-25c94",
┬а storageBucket: "voter-25c94.appspot.com"
});

let voters={}, selected=null, globalSenderNote="", activeListItem=null;
const listEl = document.getElementById("list");

// Function to load voters with error handling
function loadVoters(){
    // Show a loading message
    listEl.innerHTML = '<div style="text-align:center; padding:20px; color:#555;">Loading voter data...</div>';

    firebase.database().ref("/").once("value")
    .then(snap => {
        globalSenderNote = snap.val().GlobalSenderNote || "";
        voters = snap.val().Voters || {};

        if (Object.keys(voters).length === 0) {
            // Display message if no data is found
            listEl.innerHTML = '<div style="text-align:center; padding:20px; color:red;">рдорддрджрд╛рддрд╛ рд╕реВрдЪреА рдЦрд╛рд▓реА рд╣реИред рдХреГрдкрдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ "Voters" рдиреЛрдб рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред</div>';
        } else {
            showList(voters);
        }
    })
    .catch(error => {
        console.error("Firebase Database Error:", error);
        // Display a detailed error message to the user
        listEl.innerHTML = `<div style="text-align:center; padding:20px; color:red;">рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐: ${error.message}ред рдХреГрдкрдпрд╛ рдЕрдкрдиреЗ Firebase рдХреЗ рдирд┐рдпрдо рдФрд░ рдХрдиреЗрдХреНрд╢рди рд╡рд┐рд╡рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред</div>`;
    });
}

// Show list
function showList(data){
    listEl.innerHTML = ""; // Clear the loading/error message
┬а ┬а Object.values(data).forEach(v=>{
┬а ┬а ┬а ┬а const div = document.createElement("div");
┬а ┬а ┬а ┬а div.className = "list-item";
┬а ┬а ┬а ┬а div.innerHTML = `<b>${(v.Name||"").toLowerCase()}</b><br>ЁЯЖФ ${(v.EPIC||"").toLowerCase()} | ЁЯПЫ AC:${v.AcNo} | ЁЯУН Part:${v.PartNo}`;
┬а ┬а ┬а ┬а div.onclick = ()=>{ activeListItem=div; openPopup(v); };
┬а ┬а ┬а ┬а listEl.appendChild(div);
┬а ┬а });
}

// Open popup
function openPopup(v){
┬а ┬а selected=v;
┬а ┬а document.getElementById("pName").innerText=(v.Name||"").toLowerCase();
┬а ┬а document.getElementById("pEpic").innerText=(v.EPIC||"").toLowerCase();
┬а ┬а document.getElementById("pAc").innerText=v.AcNo;
┬а ┬а document.getElementById("pPart").innerText=v.PartNo;
┬а ┬а document.getElementById("pAddress").innerText=(v.Address||"").toLowerCase();
┬а ┬а document.getElementById("pVoteAddress").innerText=(v.VotingAddress||"").toLowerCase();
┬а ┬а document.getElementById("senderNote").value=(v.SenderNote||globalSenderNote).toLowerCase();

┬а ┬а const img=document.getElementById("voterImage");
┬а ┬а if(v.ImageURL){ img.src=v.ImageURL; img.style.display="block"; }
┬а ┬а else img.style.display="none";

┬а ┬а document.getElementById("popup").style.display="flex";
}

// Highlight
function highlightItem(){
┬а ┬а if(activeListItem) activeListItem.classList.toggle("highlight");
┬а ┬а document.getElementById("cardBox").classList.toggle("highlight");
}

// Close popup
function closePopup(){ document.getElementById("popup").style.display="none"; }

// Print
function printDetails(){ window.print(); }

// WhatsApp
function sendWhatsApp(){
┬а ┬а if(!selected) return;
┬а ┬а const msg=`ЁЯСд Name: ${(selected.Name||"").toLowerCase()}
ЁЯЖФ EPIC: ${(selected.EPIC||"").toLowerCase()}
ЁЯПа Address: ${(selected.Address||"").toLowerCase()}
ЁЯУН Booth: ${(selected.VotingAddress||"").toLowerCase()}
ЁЯУЭ Message: ${(document.getElementById("senderNote").value||"").toLowerCase()}`;
┬а ┬а window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
}

// Search
document.getElementById("search").addEventListener("input", e=>{
┬а ┬а const t=e.target.value.toLowerCase();
┬а ┬а const f=Object.values(voters).filter(v=>
┬а ┬а ┬а ┬а (v.Name||"").toLowerCase().includes(t) ||
┬а ┬а ┬а ┬а (v.EPIC||"").toLowerCase().includes(t) ||
┬а ┬а ┬а ┬а (v.AcNo+"").includes(t) ||
┬а ┬а ┬а ┬а (v.PartNo+"").includes(t) ||
┬а ┬а ┬а ┬а (v.Address||"").toLowerCase().includes(t) ||
┬а ┬а ┬а ┬а (v.VotingAddress||"").toLowerCase().includes(t) ||
┬а ┬а ┬а ┬а (v.SenderNote||"").toLowerCase().includes(t)
┬а ┬а );
┬а ┬а showList(f);
});

// Language switching
function applyLanguage(lang) {
┬а document.querySelectorAll(".label").forEach(el => {
┬а ┬а const attr = (lang === "mr") ? el.dataset.mr : el.dataset.en;
┬а ┬а if (attr !== undefined) {
┬а ┬а ┬а if (el.tagName === "INPUT" || el.tagName === "TEXTAREA") el.placeholder = attr;
┬а ┬а ┬а else el.innerText = attr;
┬а ┬а }
┬а });
}
document.getElementById("lang").addEventListener("change", function () {
┬а applyLanguage(this.value);
});

// Initial calls
loadVoters(); // Start loading data
applyLanguage("mr"); // Apply default language
</script>
</body>
</html>
